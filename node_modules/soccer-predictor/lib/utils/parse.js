"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.parseCSV = parseCSV;
var MATCH_NEWLINE = /\s*[\r\n]+\s*/g;
var DEFAULT_DELIMITER = /\s*,\s*/;

function parseCSV(string) {
  var delimiter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : DEFAULT_DELIMITER;

  var lines = string.split(MATCH_NEWLINE);
  var headers = lines[0].split(delimiter);

  return lines.slice(1).filter(filterLine).map(function (line) {
    return buildObject(headers, line.split(delimiter));
  });
}

function filterLine(line) {
  return (/[^ ,]/.test(line)
  ); // Returns false when line is just whitespace or commas
}

// Use arrays of headers and data to create an object where
// each header applies to data at the same index
function buildObject(headers, line) {
  return headers.reduce(function (object, header, index) {
    object[header] = parseValue(line[index]);
    return object;
  }, {});
}

function parseValue(value) {
  return !isNaN(value) ? +value : value; // Convert to number if numeric
}